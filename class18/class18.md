Designing a personalized cancer vaccine
================
Ivy Fernandes
3/8/2019

Protein sequences from healthy and tumor tissue
-----------------------------------------------

The following sequences resulted from such an NGS analysis of patient healthy and tumor tissue. You can also download these sequences (namedP53\_wt and P53\_mutant) as the following FASTA format sequence file lecture18\_sequences.fa

``` r
library(bio3d)
fastafile<-read.fasta("lecture18_sequences.fa")
fastafile
```

    ##              1        .         .         .         .         .         60 
    ## P53_wt       MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMDDLMLSPDDIEQWFTEDPGP
    ## P53_mutant   MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMLDLMLSPDDIEQWFTEDPGP
    ##              **************************************** ******************* 
    ##              1        .         .         .         .         .         60 
    ## 
    ##             61        .         .         .         .         .         120 
    ## P53_wt       DEAPRMPEAAPPVAPAPAAPTPAAPAPAPSWPLSSSVPSQKTYQGSYGFRLGFLHSGTAK
    ## P53_mutant   DEAPWMPEAAPPVAPAPAAPTPAAPAPAPSWPLSSSVPSQKTYQGSYGFRLGFLHSGTAK
    ##              **** ******************************************************* 
    ##             61        .         .         .         .         .         120 
    ## 
    ##            121        .         .         .         .         .         180 
    ## P53_wt       SVTCTYSPALNKMFCQLAKTCPVQLWVDSTPPPGTRVRAMAIYKQSQHMTEVVRRCPHHE
    ## P53_mutant   SVTCTYSPALNKMFCQLAKTCPVQLWVDSTPPPGTRVRAMAIYKQSQHMTEVVRRCPHHE
    ##              ************************************************************ 
    ##            121        .         .         .         .         .         180 
    ## 
    ##            181        .         .         .         .         .         240 
    ## P53_wt       RCSDSDGLAPPQHLIRVEGNLRVEYLDDRNTFRHSVVVPYEPPEVGSDCTTIHYNYMCNS
    ## P53_mutant   RCSDSDGLAPPQHLIRVEGNLRVEYLDDRNTFVHSVVVPYEPPEVGSDCTTIHYNYMCNS
    ##              ******************************** *************************** 
    ##            181        .         .         .         .         .         240 
    ## 
    ##            241        .         .         .         .         .         300 
    ## P53_wt       SCMGGMNRRPILTIITLEDSSGNLLGRNSFEVRVCACPGRDRRTEEENLRKKGEPHHELP
    ## P53_mutant   SCMGGMNRRPILTIITLEV-----------------------------------------
    ##              ******************                                           
    ##            241        .         .         .         .         .         300 
    ## 
    ##            301        .         .         .         .         .         360 
    ## P53_wt       PGSTKRALPNNTSSSPQPKKKPLDGEYFTLQIRGRERFEMFRELNEALELKDAQAGKEPG
    ## P53_mutant   ------------------------------------------------------------
    ##                                                                           
    ##            301        .         .         .         .         .         360 
    ## 
    ##            361        .         .         .  393 
    ## P53_wt       GSRAHSSHLKSKKGQSTSRHKKLMFKTEGPDSD
    ## P53_mutant   ---------------------------------
    ##                                                
    ##            361        .         .         .  393 
    ## 
    ## Call:
    ##   read.fasta(file = "lecture18_sequences.fa")
    ## 
    ## Class:
    ##   fasta
    ## 
    ## Alignment dimensions:
    ##   2 sequence rows; 393 position columns (259 non-gap, 134 gap) 
    ## 
    ## + attr: id, ali, call

seperate the healthy and the cancerous sequenes

``` r
sequences<-fastafile$ali
sequences
```

    ##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
    ## P53_wt     "M"  "E"  "E"  "P"  "Q"  "S"  "D"  "P"  "S"  "V"   "E"   "P"  
    ## P53_mutant "M"  "E"  "E"  "P"  "Q"  "S"  "D"  "P"  "S"  "V"   "E"   "P"  
    ##            [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
    ## P53_wt     "P"   "L"   "S"   "Q"   "E"   "T"   "F"   "S"   "D"   "L"  
    ## P53_mutant "P"   "L"   "S"   "Q"   "E"   "T"   "F"   "S"   "D"   "L"  
    ##            [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32]
    ## P53_wt     "W"   "K"   "L"   "L"   "P"   "E"   "N"   "N"   "V"   "L"  
    ## P53_mutant "W"   "K"   "L"   "L"   "P"   "E"   "N"   "N"   "V"   "L"  
    ##            [,33] [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42]
    ## P53_wt     "S"   "P"   "L"   "P"   "S"   "Q"   "A"   "M"   "D"   "D"  
    ## P53_mutant "S"   "P"   "L"   "P"   "S"   "Q"   "A"   "M"   "L"   "D"  
    ##            [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52]
    ## P53_wt     "L"   "M"   "L"   "S"   "P"   "D"   "D"   "I"   "E"   "Q"  
    ## P53_mutant "L"   "M"   "L"   "S"   "P"   "D"   "D"   "I"   "E"   "Q"  
    ##            [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62]
    ## P53_wt     "W"   "F"   "T"   "E"   "D"   "P"   "G"   "P"   "D"   "E"  
    ## P53_mutant "W"   "F"   "T"   "E"   "D"   "P"   "G"   "P"   "D"   "E"  
    ##            [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72]
    ## P53_wt     "A"   "P"   "R"   "M"   "P"   "E"   "A"   "A"   "P"   "P"  
    ## P53_mutant "A"   "P"   "W"   "M"   "P"   "E"   "A"   "A"   "P"   "P"  
    ##            [,73] [,74] [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82]
    ## P53_wt     "V"   "A"   "P"   "A"   "P"   "A"   "A"   "P"   "T"   "P"  
    ## P53_mutant "V"   "A"   "P"   "A"   "P"   "A"   "A"   "P"   "T"   "P"  
    ##            [,83] [,84] [,85] [,86] [,87] [,88] [,89] [,90] [,91] [,92]
    ## P53_wt     "A"   "A"   "P"   "A"   "P"   "A"   "P"   "S"   "W"   "P"  
    ## P53_mutant "A"   "A"   "P"   "A"   "P"   "A"   "P"   "S"   "W"   "P"  
    ##            [,93] [,94] [,95] [,96] [,97] [,98] [,99] [,100] [,101] [,102]
    ## P53_wt     "L"   "S"   "S"   "S"   "V"   "P"   "S"   "Q"    "K"    "T"   
    ## P53_mutant "L"   "S"   "S"   "S"   "V"   "P"   "S"   "Q"    "K"    "T"   
    ##            [,103] [,104] [,105] [,106] [,107] [,108] [,109] [,110] [,111]
    ## P53_wt     "Y"    "Q"    "G"    "S"    "Y"    "G"    "F"    "R"    "L"   
    ## P53_mutant "Y"    "Q"    "G"    "S"    "Y"    "G"    "F"    "R"    "L"   
    ##            [,112] [,113] [,114] [,115] [,116] [,117] [,118] [,119] [,120]
    ## P53_wt     "G"    "F"    "L"    "H"    "S"    "G"    "T"    "A"    "K"   
    ## P53_mutant "G"    "F"    "L"    "H"    "S"    "G"    "T"    "A"    "K"   
    ##            [,121] [,122] [,123] [,124] [,125] [,126] [,127] [,128] [,129]
    ## P53_wt     "S"    "V"    "T"    "C"    "T"    "Y"    "S"    "P"    "A"   
    ## P53_mutant "S"    "V"    "T"    "C"    "T"    "Y"    "S"    "P"    "A"   
    ##            [,130] [,131] [,132] [,133] [,134] [,135] [,136] [,137] [,138]
    ## P53_wt     "L"    "N"    "K"    "M"    "F"    "C"    "Q"    "L"    "A"   
    ## P53_mutant "L"    "N"    "K"    "M"    "F"    "C"    "Q"    "L"    "A"   
    ##            [,139] [,140] [,141] [,142] [,143] [,144] [,145] [,146] [,147]
    ## P53_wt     "K"    "T"    "C"    "P"    "V"    "Q"    "L"    "W"    "V"   
    ## P53_mutant "K"    "T"    "C"    "P"    "V"    "Q"    "L"    "W"    "V"   
    ##            [,148] [,149] [,150] [,151] [,152] [,153] [,154] [,155] [,156]
    ## P53_wt     "D"    "S"    "T"    "P"    "P"    "P"    "G"    "T"    "R"   
    ## P53_mutant "D"    "S"    "T"    "P"    "P"    "P"    "G"    "T"    "R"   
    ##            [,157] [,158] [,159] [,160] [,161] [,162] [,163] [,164] [,165]
    ## P53_wt     "V"    "R"    "A"    "M"    "A"    "I"    "Y"    "K"    "Q"   
    ## P53_mutant "V"    "R"    "A"    "M"    "A"    "I"    "Y"    "K"    "Q"   
    ##            [,166] [,167] [,168] [,169] [,170] [,171] [,172] [,173] [,174]
    ## P53_wt     "S"    "Q"    "H"    "M"    "T"    "E"    "V"    "V"    "R"   
    ## P53_mutant "S"    "Q"    "H"    "M"    "T"    "E"    "V"    "V"    "R"   
    ##            [,175] [,176] [,177] [,178] [,179] [,180] [,181] [,182] [,183]
    ## P53_wt     "R"    "C"    "P"    "H"    "H"    "E"    "R"    "C"    "S"   
    ## P53_mutant "R"    "C"    "P"    "H"    "H"    "E"    "R"    "C"    "S"   
    ##            [,184] [,185] [,186] [,187] [,188] [,189] [,190] [,191] [,192]
    ## P53_wt     "D"    "S"    "D"    "G"    "L"    "A"    "P"    "P"    "Q"   
    ## P53_mutant "D"    "S"    "D"    "G"    "L"    "A"    "P"    "P"    "Q"   
    ##            [,193] [,194] [,195] [,196] [,197] [,198] [,199] [,200] [,201]
    ## P53_wt     "H"    "L"    "I"    "R"    "V"    "E"    "G"    "N"    "L"   
    ## P53_mutant "H"    "L"    "I"    "R"    "V"    "E"    "G"    "N"    "L"   
    ##            [,202] [,203] [,204] [,205] [,206] [,207] [,208] [,209] [,210]
    ## P53_wt     "R"    "V"    "E"    "Y"    "L"    "D"    "D"    "R"    "N"   
    ## P53_mutant "R"    "V"    "E"    "Y"    "L"    "D"    "D"    "R"    "N"   
    ##            [,211] [,212] [,213] [,214] [,215] [,216] [,217] [,218] [,219]
    ## P53_wt     "T"    "F"    "R"    "H"    "S"    "V"    "V"    "V"    "P"   
    ## P53_mutant "T"    "F"    "V"    "H"    "S"    "V"    "V"    "V"    "P"   
    ##            [,220] [,221] [,222] [,223] [,224] [,225] [,226] [,227] [,228]
    ## P53_wt     "Y"    "E"    "P"    "P"    "E"    "V"    "G"    "S"    "D"   
    ## P53_mutant "Y"    "E"    "P"    "P"    "E"    "V"    "G"    "S"    "D"   
    ##            [,229] [,230] [,231] [,232] [,233] [,234] [,235] [,236] [,237]
    ## P53_wt     "C"    "T"    "T"    "I"    "H"    "Y"    "N"    "Y"    "M"   
    ## P53_mutant "C"    "T"    "T"    "I"    "H"    "Y"    "N"    "Y"    "M"   
    ##            [,238] [,239] [,240] [,241] [,242] [,243] [,244] [,245] [,246]
    ## P53_wt     "C"    "N"    "S"    "S"    "C"    "M"    "G"    "G"    "M"   
    ## P53_mutant "C"    "N"    "S"    "S"    "C"    "M"    "G"    "G"    "M"   
    ##            [,247] [,248] [,249] [,250] [,251] [,252] [,253] [,254] [,255]
    ## P53_wt     "N"    "R"    "R"    "P"    "I"    "L"    "T"    "I"    "I"   
    ## P53_mutant "N"    "R"    "R"    "P"    "I"    "L"    "T"    "I"    "I"   
    ##            [,256] [,257] [,258] [,259] [,260] [,261] [,262] [,263] [,264]
    ## P53_wt     "T"    "L"    "E"    "D"    "S"    "S"    "G"    "N"    "L"   
    ## P53_mutant "T"    "L"    "E"    "V"    "-"    "-"    "-"    "-"    "-"   
    ##            [,265] [,266] [,267] [,268] [,269] [,270] [,271] [,272] [,273]
    ## P53_wt     "L"    "G"    "R"    "N"    "S"    "F"    "E"    "V"    "R"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,274] [,275] [,276] [,277] [,278] [,279] [,280] [,281] [,282]
    ## P53_wt     "V"    "C"    "A"    "C"    "P"    "G"    "R"    "D"    "R"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,283] [,284] [,285] [,286] [,287] [,288] [,289] [,290] [,291]
    ## P53_wt     "R"    "T"    "E"    "E"    "E"    "N"    "L"    "R"    "K"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,292] [,293] [,294] [,295] [,296] [,297] [,298] [,299] [,300]
    ## P53_wt     "K"    "G"    "E"    "P"    "H"    "H"    "E"    "L"    "P"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,301] [,302] [,303] [,304] [,305] [,306] [,307] [,308] [,309]
    ## P53_wt     "P"    "G"    "S"    "T"    "K"    "R"    "A"    "L"    "P"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,310] [,311] [,312] [,313] [,314] [,315] [,316] [,317] [,318]
    ## P53_wt     "N"    "N"    "T"    "S"    "S"    "S"    "P"    "Q"    "P"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,319] [,320] [,321] [,322] [,323] [,324] [,325] [,326] [,327]
    ## P53_wt     "K"    "K"    "K"    "P"    "L"    "D"    "G"    "E"    "Y"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,328] [,329] [,330] [,331] [,332] [,333] [,334] [,335] [,336]
    ## P53_wt     "F"    "T"    "L"    "Q"    "I"    "R"    "G"    "R"    "E"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,337] [,338] [,339] [,340] [,341] [,342] [,343] [,344] [,345]
    ## P53_wt     "R"    "F"    "E"    "M"    "F"    "R"    "E"    "L"    "N"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,346] [,347] [,348] [,349] [,350] [,351] [,352] [,353] [,354]
    ## P53_wt     "E"    "A"    "L"    "E"    "L"    "K"    "D"    "A"    "Q"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,355] [,356] [,357] [,358] [,359] [,360] [,361] [,362] [,363]
    ## P53_wt     "A"    "G"    "K"    "E"    "P"    "G"    "G"    "S"    "R"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,364] [,365] [,366] [,367] [,368] [,369] [,370] [,371] [,372]
    ## P53_wt     "A"    "H"    "S"    "S"    "H"    "L"    "K"    "S"    "K"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,373] [,374] [,375] [,376] [,377] [,378] [,379] [,380] [,381]
    ## P53_wt     "K"    "G"    "Q"    "S"    "T"    "S"    "R"    "H"    "K"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,382] [,383] [,384] [,385] [,386] [,387] [,388] [,389] [,390]
    ## P53_wt     "K"    "L"    "M"    "F"    "K"    "T"    "E"    "G"    "P"   
    ## P53_mutant "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"    "-"   
    ##            [,391] [,392] [,393]
    ## P53_wt     "D"    "S"    "D"   
    ## P53_mutant "-"    "-"    "-"

``` r
healthy<-sequences[1,]
cancer<-sequences[2,]
healthy
```

    ##   [1] "M" "E" "E" "P" "Q" "S" "D" "P" "S" "V" "E" "P" "P" "L" "S" "Q" "E"
    ##  [18] "T" "F" "S" "D" "L" "W" "K" "L" "L" "P" "E" "N" "N" "V" "L" "S" "P"
    ##  [35] "L" "P" "S" "Q" "A" "M" "D" "D" "L" "M" "L" "S" "P" "D" "D" "I" "E"
    ##  [52] "Q" "W" "F" "T" "E" "D" "P" "G" "P" "D" "E" "A" "P" "R" "M" "P" "E"
    ##  [69] "A" "A" "P" "P" "V" "A" "P" "A" "P" "A" "A" "P" "T" "P" "A" "A" "P"
    ##  [86] "A" "P" "A" "P" "S" "W" "P" "L" "S" "S" "S" "V" "P" "S" "Q" "K" "T"
    ## [103] "Y" "Q" "G" "S" "Y" "G" "F" "R" "L" "G" "F" "L" "H" "S" "G" "T" "A"
    ## [120] "K" "S" "V" "T" "C" "T" "Y" "S" "P" "A" "L" "N" "K" "M" "F" "C" "Q"
    ## [137] "L" "A" "K" "T" "C" "P" "V" "Q" "L" "W" "V" "D" "S" "T" "P" "P" "P"
    ## [154] "G" "T" "R" "V" "R" "A" "M" "A" "I" "Y" "K" "Q" "S" "Q" "H" "M" "T"
    ## [171] "E" "V" "V" "R" "R" "C" "P" "H" "H" "E" "R" "C" "S" "D" "S" "D" "G"
    ## [188] "L" "A" "P" "P" "Q" "H" "L" "I" "R" "V" "E" "G" "N" "L" "R" "V" "E"
    ## [205] "Y" "L" "D" "D" "R" "N" "T" "F" "R" "H" "S" "V" "V" "V" "P" "Y" "E"
    ## [222] "P" "P" "E" "V" "G" "S" "D" "C" "T" "T" "I" "H" "Y" "N" "Y" "M" "C"
    ## [239] "N" "S" "S" "C" "M" "G" "G" "M" "N" "R" "R" "P" "I" "L" "T" "I" "I"
    ## [256] "T" "L" "E" "D" "S" "S" "G" "N" "L" "L" "G" "R" "N" "S" "F" "E" "V"
    ## [273] "R" "V" "C" "A" "C" "P" "G" "R" "D" "R" "R" "T" "E" "E" "E" "N" "L"
    ## [290] "R" "K" "K" "G" "E" "P" "H" "H" "E" "L" "P" "P" "G" "S" "T" "K" "R"
    ## [307] "A" "L" "P" "N" "N" "T" "S" "S" "S" "P" "Q" "P" "K" "K" "K" "P" "L"
    ## [324] "D" "G" "E" "Y" "F" "T" "L" "Q" "I" "R" "G" "R" "E" "R" "F" "E" "M"
    ## [341] "F" "R" "E" "L" "N" "E" "A" "L" "E" "L" "K" "D" "A" "Q" "A" "G" "K"
    ## [358] "E" "P" "G" "G" "S" "R" "A" "H" "S" "S" "H" "L" "K" "S" "K" "K" "G"
    ## [375] "Q" "S" "T" "S" "R" "H" "K" "K" "L" "M" "F" "K" "T" "E" "G" "P" "D"
    ## [392] "S" "D"

``` r
cancer
```

    ##   [1] "M" "E" "E" "P" "Q" "S" "D" "P" "S" "V" "E" "P" "P" "L" "S" "Q" "E"
    ##  [18] "T" "F" "S" "D" "L" "W" "K" "L" "L" "P" "E" "N" "N" "V" "L" "S" "P"
    ##  [35] "L" "P" "S" "Q" "A" "M" "L" "D" "L" "M" "L" "S" "P" "D" "D" "I" "E"
    ##  [52] "Q" "W" "F" "T" "E" "D" "P" "G" "P" "D" "E" "A" "P" "W" "M" "P" "E"
    ##  [69] "A" "A" "P" "P" "V" "A" "P" "A" "P" "A" "A" "P" "T" "P" "A" "A" "P"
    ##  [86] "A" "P" "A" "P" "S" "W" "P" "L" "S" "S" "S" "V" "P" "S" "Q" "K" "T"
    ## [103] "Y" "Q" "G" "S" "Y" "G" "F" "R" "L" "G" "F" "L" "H" "S" "G" "T" "A"
    ## [120] "K" "S" "V" "T" "C" "T" "Y" "S" "P" "A" "L" "N" "K" "M" "F" "C" "Q"
    ## [137] "L" "A" "K" "T" "C" "P" "V" "Q" "L" "W" "V" "D" "S" "T" "P" "P" "P"
    ## [154] "G" "T" "R" "V" "R" "A" "M" "A" "I" "Y" "K" "Q" "S" "Q" "H" "M" "T"
    ## [171] "E" "V" "V" "R" "R" "C" "P" "H" "H" "E" "R" "C" "S" "D" "S" "D" "G"
    ## [188] "L" "A" "P" "P" "Q" "H" "L" "I" "R" "V" "E" "G" "N" "L" "R" "V" "E"
    ## [205] "Y" "L" "D" "D" "R" "N" "T" "F" "V" "H" "S" "V" "V" "V" "P" "Y" "E"
    ## [222] "P" "P" "E" "V" "G" "S" "D" "C" "T" "T" "I" "H" "Y" "N" "Y" "M" "C"
    ## [239] "N" "S" "S" "C" "M" "G" "G" "M" "N" "R" "R" "P" "I" "L" "T" "I" "I"
    ## [256] "T" "L" "E" "V" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [273] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [290] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [307] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [324] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [341] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [358] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [375] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"
    ## [392] "-" "-"

create a vector that determines if healthy = cancerous

``` r
alignment<- healthy == cancer
head(alignment)
```

    ## [1] TRUE TRUE TRUE TRUE TRUE TRUE

which indices are conserved?

``` r
# conserved<-conserv(fastafile)
# conserved
mutations<-which(alignment<1)
```

want to exclude gap sites because that is not a mismatch

``` r
gaps<-gap.inspect(fastafile)
gaps
```

    ## $t.inds
    ##   [1] 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276
    ##  [18] 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
    ##  [35] 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310
    ##  [52] 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327
    ##  [69] 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344
    ##  [86] 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361
    ## [103] 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378
    ## [120] 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393
    ## 
    ## $f.inds
    ##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
    ##  [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34
    ##  [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51
    ##  [52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68
    ##  [69]  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85
    ##  [86]  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102
    ## [103] 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119
    ## [120] 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136
    ## [137] 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153
    ## [154] 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170
    ## [171] 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187
    ## [188] 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204
    ## [205] 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221
    ## [222] 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238
    ## [239] 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255
    ## [256] 256 257 258 259
    ## 
    ## $row
    ## [1]   0 134
    ## 
    ## $col
    ##   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ##  [36] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ##  [71] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ## [106] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ## [141] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ## [176] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ## [211] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
    ## [246] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
    ## [281] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
    ## [316] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
    ## [351] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
    ## [386] 1 1 1 1 1 1 1 1
    ## 
    ## $bin
    ##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
    ## [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0
    ## [2,]    0    0    0    0    0    0    0    0    0     0     0     0     0
    ##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66] [,67] [,68]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77] [,78] [,79]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88] [,89] [,90]
    ## [1,]     0     0     0     0     0     0     0     0     0     0     0
    ## [2,]     0     0     0     0     0     0     0     0     0     0     0
    ##      [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99] [,100] [,101]
    ## [1,]     0     0     0     0     0     0     0     0     0      0      0
    ## [2,]     0     0     0     0     0     0     0     0     0      0      0
    ##      [,102] [,103] [,104] [,105] [,106] [,107] [,108] [,109] [,110] [,111]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,112] [,113] [,114] [,115] [,116] [,117] [,118] [,119] [,120] [,121]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,122] [,123] [,124] [,125] [,126] [,127] [,128] [,129] [,130] [,131]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,132] [,133] [,134] [,135] [,136] [,137] [,138] [,139] [,140] [,141]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,142] [,143] [,144] [,145] [,146] [,147] [,148] [,149] [,150] [,151]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,152] [,153] [,154] [,155] [,156] [,157] [,158] [,159] [,160] [,161]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,162] [,163] [,164] [,165] [,166] [,167] [,168] [,169] [,170] [,171]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,172] [,173] [,174] [,175] [,176] [,177] [,178] [,179] [,180] [,181]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,182] [,183] [,184] [,185] [,186] [,187] [,188] [,189] [,190] [,191]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,192] [,193] [,194] [,195] [,196] [,197] [,198] [,199] [,200] [,201]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,202] [,203] [,204] [,205] [,206] [,207] [,208] [,209] [,210] [,211]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,212] [,213] [,214] [,215] [,216] [,217] [,218] [,219] [,220] [,221]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,222] [,223] [,224] [,225] [,226] [,227] [,228] [,229] [,230] [,231]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,232] [,233] [,234] [,235] [,236] [,237] [,238] [,239] [,240] [,241]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,242] [,243] [,244] [,245] [,246] [,247] [,248] [,249] [,250] [,251]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      0      0
    ##      [,252] [,253] [,254] [,255] [,256] [,257] [,258] [,259] [,260] [,261]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      0      0      0      0      0      0      0      0      1      1
    ##      [,262] [,263] [,264] [,265] [,266] [,267] [,268] [,269] [,270] [,271]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,272] [,273] [,274] [,275] [,276] [,277] [,278] [,279] [,280] [,281]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,282] [,283] [,284] [,285] [,286] [,287] [,288] [,289] [,290] [,291]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,292] [,293] [,294] [,295] [,296] [,297] [,298] [,299] [,300] [,301]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,302] [,303] [,304] [,305] [,306] [,307] [,308] [,309] [,310] [,311]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,312] [,313] [,314] [,315] [,316] [,317] [,318] [,319] [,320] [,321]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,322] [,323] [,324] [,325] [,326] [,327] [,328] [,329] [,330] [,331]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,332] [,333] [,334] [,335] [,336] [,337] [,338] [,339] [,340] [,341]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,342] [,343] [,344] [,345] [,346] [,347] [,348] [,349] [,350] [,351]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,352] [,353] [,354] [,355] [,356] [,357] [,358] [,359] [,360] [,361]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,362] [,363] [,364] [,365] [,366] [,367] [,368] [,369] [,370] [,371]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,372] [,373] [,374] [,375] [,376] [,377] [,378] [,379] [,380] [,381]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,382] [,383] [,384] [,385] [,386] [,387] [,388] [,389] [,390] [,391]
    ## [1,]      0      0      0      0      0      0      0      0      0      0
    ## [2,]      1      1      1      1      1      1      1      1      1      1
    ##      [,392] [,393]
    ## [1,]      0      0
    ## [2,]      1      1

want to identify where the mutations are within the non-gap regions

``` r
mutant.sites <- mutations[mutations %in% gaps$f.inds]

mutant.sites
```

    ## [1]  41  65 213 259

``` r
## Make a "names" label for our output sequences (one per mutant)
mutant.names <- paste0(fastafile$ali["P53_wt",mutant.sites],
                       mutant.sites,
                       fastafile$ali["P53_mutant",mutant.sites])

mutant.names
```

    ## [1] "D41L"  "R65W"  "R213V" "D259V"

``` r
## Sequence positions surounding each mutant site
start.position <- mutant.sites - 8
end.position <-  mutant.sites + 8

# Blank matrix to store sub-sequences
store.seqs <- matrix("-", nrow=length(mutant.sites), ncol=17)
rownames(store.seqs) <- mutant.names

## Extract each sub-sequence
for(i in 1:length(mutant.sites)) {
  store.seqs[i,] <- fastafile$ali["P53_mutant",start.position[i]:end.position[i]]
}

store.seqs
```

    ##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
    ## D41L  "S"  "P"  "L"  "P"  "S"  "Q"  "A"  "M"  "L"  "D"   "L"   "M"   "L"  
    ## R65W  "D"  "P"  "G"  "P"  "D"  "E"  "A"  "P"  "W"  "M"   "P"   "E"   "A"  
    ## R213V "Y"  "L"  "D"  "D"  "R"  "N"  "T"  "F"  "V"  "H"   "S"   "V"   "V"  
    ## D259V "I"  "L"  "T"  "I"  "I"  "T"  "L"  "E"  "V"  "-"   "-"   "-"   "-"  
    ##       [,14] [,15] [,16] [,17]
    ## D41L  "S"   "P"   "D"   "D"  
    ## R65W  "A"   "P"   "P"   "V"  
    ## R213V "V"   "P"   "Y"   "E"  
    ## D259V "-"   "-"   "-"   "-"

``` r
## First blank out the gap positions 
store.seqs[store.seqs == "-"] <- ""

## Output a FASTA file for further analysis
write.fasta(seqs=store.seqs, ids=mutant.names, file="subsequences.fa")
```
